
<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

  <link href="{% static 'css/style.css' %}" rel="stylesheet" type="text/css" >
 
  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
    integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk"
    crossorigin="anonymous"></script>
  <title>home</title>
  
</head>

<body>
  <div class="container">
    <nav class="navbar navbar-expand-lg" style="background-color: #08e4f8eb;">
      <div class="container">
        <a class="navbar-brand" href="#"><span class="text-primary"><b>Food</b></span><span
            class="text-success">Tracking</span></a>

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">

            <li class="nav-item">
              <a class="nav-link active.text-dark" href="{% url 'homepage' %}">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'login' %}">Login</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'register' %}">Register User</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Support</a>
            </li>


          </ul>
          <form class="d-flex" role="search">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
          </form>
        </div>
      </div>
    </nav>
    <br><br>
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="true">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"
          aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
          aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
          aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img src="{% static 'images/digital1.jpg' %}" class="d-block h-50 w-50" alt="Loading">
        </div>
        <div class="carousel-item">
          <img src="{% static 'images/digital2.jpg' %}" class="d-block w-100" alt="...">
        </div>
        <div class="carousel-item">
          <img src="{% static 'images/digital3.jpg' %}" class="d-block w-100" alt="...">
        </div>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
        data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
        data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    <div class="container">
      <div>
        <h2>Percentage of carbs</h2>
        <div class="progress">
          <div class="progress-bar bg-success" role="progressbar" aria-label="Success example" style="width: %"
            aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
        </div><br>
        <h3>Percentage of carbs</h3>
        <div class="progress">
          <div class="progress-bar bg-info" role="progressbar" aria-label="Info example" style="width: %"
            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
        </div><br>
        <h4>Percentage of carbs</h4>
        <div class="progress">
          <div class="progress-bar bg-warning" role="progressbar" aria-label="Warning example" style="width: %"
            aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
        </div><br>
        <h5>Percentage of carbs</h5>
        <div class="progress">
          <div class="progress-bar bg-danger" role="progressbar" aria-label="Danger example" style="width: %"
            aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
        </div>
        <br>
        <div class="row">
          <div class="col-sm-3">
            <h2>Choose the food:</h2>
          </div>
          <div class="col-sm-6">
            <div class="container drop">
              <form method="POST">
                {% csrf_token %}
                <select name="consumed_food" id="consumed_food">
                  <option>Select Food</option>
                  {% for food in data %}
                  <option value="{{food.name}}">{{food.name}}</option>
                  {% endfor %}
                </select>
                <button type="submit" class="btn btn-success btn-sm">Add to list</button>
              </form>
            </div>
          </div>
          <div class="col-sm-3">
            <div class="col-sm-3">
              <a href="{% url 'logout' %}" class="btn btn-success">logout</a>
            </div>
  
          </div>
          <br>
        </div>

        <div class="row">
           <div class="col-sm-6">
            <table class="table table-bordered" Id="table">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Carbs</th>
                  <th>Protein</th>
                  <th>Fats</th>
                  <th>Calory</th>
                  <th>Action</th>
                </tr>
              </thead>


              <tbody>
                {% for food in consumed_food %}
                <tr>
                  <td>{{food.food_consume.name}}</td>
                  <td>{{food.food_consume.carbs}}</td>
                  <td>{{food.food_consume.protein}}</td>
                  <td>{{food.food_consume.fats}}</td>
                  <td>{{food.food_consume.calory}}</td>
                  <td><a href="{% url 'del_food' food.id %}" class="btn btn-danger">Remove</a></td>
                </tr>
                {% endfor %}
                <tr>
                  <td><b>Total</b> </td>
                  <td id="carbs"><b> </b></td>
                  <td id="protein"><b> </b></td>
                  <td id="fats"><b> </b></td>
                  <td id="calory"><b> </b></td>
                </tr>

              </tbody>
            </table>
          </div>
          <br>
          <div class="col-sm-6">
            <h4>Show the graphical way</h4>
            <canvas id="myChart" width="50vh" height="50vh"></canvas>
            <div class="piechart"></div>
          </div>
        </div>

      </div>
    </div>
</body>
<script type="text/javascript">
  var table = document.getElementById("table");
  var carbs = 0, protein = 0, fats = 0, calory = 0;
  for (var i = 1; i < table.rows.length - 1; i++) {
    console.log(table.rows[i].cells[1].innerHTML);
    carbs = carbs + parseFloat(table.rows[i].cells[1].innerHTML);
    carbs = Math.round(carbs)
    protein = protein + parseFloat(table.rows[i].cells[2].innerHTML);
    protein = Math.round(protein)
    fats = fats + parseFloat(table.rows[i].cells[3].innerHTML);
    fats = Math.round(fats)
    calory = calory + parseFloat(table.rows[i].cells[4].innerHTML);
    calory = Math.round(calory)

  }
  console.log(calory);
  document.getElementById("carbs").innerHTML = carbs

  document.getElementById("protein").innerHTML = protein

  document.getElementById("fats").innerHTML = fats

  document.getElementById("calory").innerHTML = calory

  carper = (carbs / 1000) * 100
  document.getElementsByClassName("progress-bar")[0].setAttribute("style", "width:" + carper + "%")

  proper = (protein / 1000) * 100
  document.getElementsByClassName("progress-bar")[1].setAttribute("style", "width:" + proper + "%")

  fatper = (fats / 1000) * 100
  document.getElementsByClassName("progress-bar")[2].setAttribute("style", "width:" + fatper + "%")

  calper = (calory / 1000) * 100
  document.getElementsByClassName("progress-bar")[3].setAttribute("style", "width:" + calper + "%")



  var total = carbs + protein + fats + calory

  var carbsperc = Math.round((carbs / total) * 100)
  var proteinperc = Math.round((protein / total) * 100)
  var fatsperc = Math.round((fats / total) * 100)
  var caloryperc = Math.round((calory / total) * 100)



  const ctx = document.getElementById('myChart').getContext('2d');
  const myChart = new Chart(ctx, {
    type: 'pie',
    data: {
      labels: ['Carbohydrate' + "%", 'Protein' + "%", 'Fats' + "%", 'Calorie' + "%"],
      datasets: [{
        label: '# of Votes',
        data: [carbsperc, proteinperc, fatsperc, caloryperc],
        backgroundColor: [
          'rgba(255, 99, 132, 0.2)',
          'rgba(54, 162, 235, 0.2)',
          'rgba(255, 206, 86, 0.2)',
          'rgba(75, 192, 192, 0.2)',

        ],
        borderColor: [
          'rgba(255, 99, 132, 1)',
          'rgba(54, 162, 235, 1)',
          'rgba(255, 206, 86, 1)',
          'rgba(75, 192, 192, 1)',
        ],
        borderWidth: 1
      }]
    },
  }
  );
</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
  integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"
  integrity="sha384-IDwe1+LCz02ROU9k972gdyvl+AESN10+x7tBKgc9I5HFtuNz0wWnPclzo6p9vxnk" crossorigin="anonymous"></script>

</html>